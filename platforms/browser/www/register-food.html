<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
 
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" href="./fontawesome-free-5.15.1-web/fontawesome-free-5.15.1-web/css/all.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <title>Register Food</title>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script type="text/javascript">
    //food-name, food-price, food-class, food-type, initial-stock, add-photo, regis-food-btn
        $(document).ready(function() {
            $(".regis-food-btn").click(function() {  

                let bus_id = localStorage.getItem("bus_id");
                var food_name = $(".food-name").val();
                var food_price = $(".food-price").val();
                var food_class = $(".food-class").val();
                var food_type = $(".food-type").val();
                var initial_stock = $(".initial-stock").val();
                var add_photo = $("#file")[0].files[0].toString();

        
                console.log(add_photo);
                var dataString = "food_name=" + food_name + "&food_price=" + food_price + "&food_class=" + food_class +
                "&food_type="+ food_type + "&initial_stock=" + initial_stock + "&add_photo=" + add_photo + "&bus_id=" + bus_id +
                "&food_insert=";
                console.log(dataString);
                if ($.trim(food_name).length > 0 & $.trim(food_price).length > 0 & $.trim(food_class).length > 0 &
                $.trim(food_type).length > 0 & $.trim(initial_stock).length > 0 & $.trim(add_photo).length > 0 &
                $.trim(bus_id).length > 0)
                {
                    $.ajax({
                        type: "POST",
                        url: "http://192.168.254.118/final_project/platforms/browser/www/server/insert.php",  
                        data: dataString,
                        crossDomain: true,  
                        cache: false,  
                        beforeSend: function() {
                        
                        },
                        success: function(data) {
                            console.log(data);
                            if (data == "success") {  
                                //alert("inserted");
                                location.reload(true);
                            } else if (data == "error") {  
                                alert("error");

                            }
                        }
                    });
                    
                }
                return false;
            });
        });
        </script>
        <script type="text/javascript">
            $(document).ready(function() {
                var url = "http://192.168.254.118/final_project/platforms/browser/www/server/food_json.php";
                $.getJSON(url, function(result) {  
                //console.log(result);
                    let bus_id = localStorage.getItem("bus_id");
                    $.each(result, function(i, field) {
                    
                    if(bus_id === field.owner_id) {
            
                        var name = field.food_name;
                        var price = field.food_price;
                        var classification = field.food_classification;
                        var type = field.food_type;
                        var stock = field.stock_qty;
                        var photo = field.food_photo;
                        console.log(photo);

                        //href="`+ `register-food.html?"food_name=" + name + "&food_price=" + price + "&food_class=" + classification +
                        //"&food_type="+ type + "&initial_stock=" + stock + "&add_photo=" + photo +
                        //"&food_insert="
                        $(".display-menu").append(`
                        <div class="menu-card">
                            <div class="food-image">
                                <img src="url(`+photo+`)" alt="">
                            </div>
                            <div class="food-desc">
                                <p>Name:` + name + `</p>
                                <p>Price: Php` + price + `</p>
                                <p>Stock:` + stock + `serving/s</p>
                                <p>Classification:` + classification +`</p>
                                <p>Type:` + type +`</p>
                            </div>
                            <div class="menu-btns">
                                <button class="regis-update-btn">Update</button>
                                <button class="regis-archive">Archive</button>
                            </div>
                        </div>
                        `);
                    //let food_class_filter= $(".food-class-filter").val();
                    //let food_type_filter= $(".food-type-filter").val();
                    $(".filter").on("click", function() {
                        let value = $(".food-class-filter").val().toLowerCase();
                        let value2 = $(".food-type-filter").val().toLowerCase();
                        $(".menu-card").filter(function() {
                        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                        $(this).toggle($(this).text().toLowerCase().indexOf(value2) > -1)
                        });
                    });

                    $(".display-all").on("click", function() {
                        location.reload(true);
                    });

                        }
                    });
                });
            });
        </script>
</head>

<body>
    <div class="main-page-wrapper">
        <brandname-section class="brandname">
            <div class="bn-holder">
                <img src="./img/gawis-invert-nomargin.jpg" alt="">
            </div>
        </brandname-section>
        <topbar-section>
            <div class="burger-search">
                <i class="fas fa-bars" id="open-sidenav"></i>
                <input type="text" placeholder="Search..." class="search-bar"><button class="search-btn"><i class="fas fa-search"></i></button>
            </div>
            <div class="admin-logout">
                <button class="admin-btn"><i class="fas fa-user"></i></button>
                <button class="logout" onclick="logout_modal_pop()">Log out</button>
            </div>
        </topbar-section>
        <sidenav-section  class="sidenav-collapsed">
            <div class="sidenav">
                <a href="./dashboard.html"><i class="fas fa-caret-square-down"></i>
                    <br>Dashboard</a>
                <a href="./subscribers.html"><i class="fas fa-users"></i>
                    <br>Subscribers</a>
                <a href="./register-food.html" class="current"><i class="far fa-list-alt"></i>
                    <br>Register Food</a>
                <a href="./add-menu.html"><i class="fas fa-clipboard-list"></i>
                    <br>Add Menu</a>
                <a href="./received-order.html"><i class="fas fa-inbox"></i>
                    <br>Received Order</a>
                <a href="./delivery-pickup.html"><i class="fas fa-truck"></i>
                    <br>For Delivery or Pick Up</a>
                <a href="./sales.html"><i class="far fa-chart-bar"></i>
                    <br>Sales</a>
                    <br>
                <p class="close-sidenav"><i class="fas fa-chevron-left"></i> Collapse</p>
            </div>
        </sidenav-section>
        <main-section>
            <div class="regis-food-tab">
                <div class="regis-title">
                    <h3>Registered Food and Stock</h3>
                </div>
                <div class="regis-menu">
                    <div class="menu-filter">
                        <h5>Classification:</h5>
                        <select class="food-class-filter filter-select" id="food-class-filter">
                            <option value=""></option>
                            <option value="Single">Single</option>
                            <option value="Combo">Combo</option>
                        </select>
                        <h5>Type:</h5>
                        <select class="food-type-filter filter-select" id="food-type-filter">
                            <option value=""></option>
                            <option value="Snack">Snack</option>
                            <option value="Meal">Meal</option>
                            <option value="Beverage">Beverage</option>
                            <option value="Snackbeverage">Snack-Beverage</option>
                            <option value="Mealbeverage">Meal-Beverage</option>
                        </select>

                        <button class="filter">Filter</button>
                        <button class="display-all">Display All</button>
                    </div>
                    <div class="display-menu">
                        <div class="menu-card">
                            <div class="food-image">
                                <img src="./img/pexels-ella-olsson-1640777.jpg" alt="">
                            </div>
                            <div class="food-desc">
                                <p>Name: Food Name</p>
                                <p>Price: Php 100.00</p>
                                <p>Stock: 5 servings</p>
                                <p>Classification: Single</p>
                                <p>Type: Meal</p>
                            </div>
                            <div class="menu-btns">
                                <button class="regis-update-btn">Update</button>
                                <button class="regis-archive">Archive</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="regis-food-card">
                    <div class="food-card">
                        <img src="./img/GAWIS-PIC-LOGO-final.jpg" alt="" class="logo">
                        <h3>Register Food.</h3>
                        
                        <h5 class="top">Food Name</h5>
                        <input type="text" placeholder="Enter food name" class="food-name" id="food-name">
        
                        <h5>Food Price</h5>
                        <input type="text" placeholder="Enter food price" class="food-price" id="food-price">
        
                        <h5>Classification</h5>
                        <select class="food-class" id="food-class" name="classification">
                            <option value="Single">Single</option>
                            <option value="Combo">Combo</option>
                        </select>
        
                        <h5>Type</h5>
                        <select class="food-type" id="food-type" name="food-type">
                            <option value="Snack">Snack</option>
                            <option value="Meal">Meal</option>
                            <option value="Beverage">Beverage</option>
                            <option value="Snackbeverage">Combo-snack</option>
                            <option value="Mealbeverage">Meal-Beverage</option>
                        </select>
  
                        <h5>Initial Stock</h5>
                        <input type="number" placeholder="Enter initial stock" class="initial-stock" id="initial-stock">
        
                        <h5>Add Photo</h5>
                        <input type="file" class="add-photo" id="file" accept="image/png, image/jpeg">

                        <br>
                        <button class="regis-food-btn" id="regis-food-insert">Register</button>
                    </div>
                </div>
            </div>
        </main-section>
        <div class="logout-modal-container">
            <div class="logout-card">
                <img src="./img/GAWIS-PIC-LOGO-final.jpg" alt="" class="logo">
                <h3>Log Out.</h3>

                <h5 class="label-top">Are you sure, you want to log out?</h5>
                <br>
                <button class="logout-btn" onclick="logout_action()">Log Out</button>
                <button class="cancel-logout-btn" onclick="cancel_logout_modal()">Cancel</button>
            </div>
        </div>
        
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
</body>

</html>
